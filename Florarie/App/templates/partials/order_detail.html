{% extends 'base.html' %}
{% block content %}

<div class="container mx-auto py-36 mt-24 min-h-screen">
    <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold mb-6">Comanda #{{ order.id }}</h2>
        
        <!-- Statuz comanda -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold mb-4">Informații comandă</h3>
                    <div class="space-y-2">
                        <p><span class="font-medium">Data plasării:</span> {{ order.created_at|date:"d/m/Y, H:i" }}</p>
                        <p><span class="font-medium">Status plată:</span> 
                            {% if order.payment_status %}
                                <span class="text-green-600 font-semibold">Plătit</span>
                            {% else %}
                                <span class="text-red-600 font-semibold">În așteptare</span>
                            {% endif %}
                        </p>
                        <p><span class="font-medium">Metodă plată:</span> 
                            {% if order.payment_method == 'card' %}
                                Card bancar
                            {% else %}
                                Plata la livrare
                            {% endif %}
                        </p>
                        <p><span class="font-medium">Subtotal:</span> {{ order.total_price }} Lei</p>
                        <p><span class="font-medium">Taxă livrare:</span> {{ order.delivery_fee }} Lei</p>
                        <p><span class="font-medium">Total:</span> <span class="text-xl font-bold text-blue-600">{{ order.final_total }} Lei</span></p>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Informații client</h3>
                    <div class="space-y-2">
                        <p><span class="font-medium">Nume:</span> {{ order.full_name }}</p>
                        <p><span class="font-medium">Email:</span> {{ order.email }}</p>
                        <p><span class="font-medium">Telefon:</span> {{ order.phone_number }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Informații livrare -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4">Informații livrare</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <p><span class="font-medium">Tip livrare:</span> 
                        {% if order.delivery_type == 'delivery' %}
                            <span class="text-blue-600 font-semibold">Livrare la adresă</span>
                        {% else %}
                            <span class="text-green-600 font-semibold">Ridicare personală</span>
                        {% endif %}
                    </p>
                    
                    {% if order.desired_delivery_date %}
                        <p><span class="font-medium">Data dorită:</span> {{ order.desired_delivery_date|date:"d/m/Y" }}</p>
                    {% endif %}
                    
                    {% if order.delivery_time_slot %}
                        <p><span class="font-medium">Interval orar:</span> {{ order.get_delivery_time_slot_display }}</p>
                    {% endif %}
                    
                    {% if order.delivery_notes %}
                        <p><span class="font-medium">Mentiuni:</span> {{ order.delivery_notes }}</p>
                    {% endif %}
                </div>
                
                {% if order.delivery_type == 'delivery' %}
                <div>
                    <h4 class="font-medium mb-2">Adresa de livrare:</h4>
                    <div class="space-y-1">
                        {% if order.address %}
                            <p>{{ order.address }}</p>
                        {% endif %}
                        {% if order.city %}
                            <p>{{ order.city }}</p>
                        {% endif %}
                        {% if order.zip_code %}
                            <p>Cod poștal: {{ order.zip_code }}</p>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Produse comandate -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4">Produse comandate</h3>
            <div class="space-y-4">
        {% for item in order_items %}
                <div class="flex items-center justify-between border-b border-gray-200 pb-4">
            <div class="flex items-center gap-4">
                        <img src="{{ item.product.image.url }}" class="w-20 h-20 rounded-lg object-cover" alt="{{ item.product.name }}">
                <div>
                            <h4 class="font-semibold text-lg">{{ item.product.name }}</h4>
                            <p class="text-gray-600">Cantitate: {{ item.quantity }}</p>
                            <p class="text-sm text-gray-500">Preț unitar: {{ item.price }} Lei</p>
                </div>
            </div>
                    <div class="text-right">
                        <p class="font-semibold text-lg">{{ item.price|floatformat:2 }} Lei</p>
                    </div>
        </div>
        {% endfor %}
    </div>

            <!-- Rezumat comanda -->
            <div class="mt-6 pt-4 border-t border-gray-200">
                <div class="flex justify-between items-center text-lg">
                    <span class="font-medium">Subtotal:</span>
                    <span>{{ order.total_price }} Lei</span>
                </div>
                <div class="flex justify-between items-center text-lg">
                    <span class="font-medium">Taxă livrare:</span>
                    <span>{{ order.delivery_fee }} Lei</span>
                </div>
                <div class="flex justify-between items-center text-xl font-bold text-blue-600 mt-2 pt-2 border-t border-gray-200">
                    <span>Total:</span>
                    <span>{{ order.final_total }} Lei</span>
                </div>
            </div>
        </div>

        <div class="flex gap-4">
        <a href="{% url 'profile' %}" class="btn btn-primary">Înapoi la Comenzi</a>
        </div>
    </div>
</div>

{% endblock %}
